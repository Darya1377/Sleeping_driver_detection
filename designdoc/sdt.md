# sleeping_driver_detection
# ML System Design Doc - [RU]
# Дизайн ML системы «Детекция уставших водителей» MVP 1.0
# 1. Цели и предпосылки
## 1.1 Зачем идем в разработку продукта?
### Бизнес-цель
Согласно статистике, 32% россиян хотя бы раз засыпали за рулём автомобиля, а 3.8% из них просыпались уже от столкновения. Особую опасность представаляют собой водители различных сервисов такси, так как на них лежит дополнительная ответственность за сохранность пассажиров. Для сокращения числа случаев данных инцидентов, нашей командой была разработана задумка по созданию мобильного приложения, которое обнаруживает признаки усталости водителя и воспроизводит звуковой сигнал достаточной громкости, чтобы разбудить человека за рулем.

Рассматриваемые прикладные задачи:
- поиск датасета с фото водителей;
- разметка датасета с делением на 2 категории: "бодрый" и "спящий";
- обучение нейронной сети Yolo5 на размеченной выборке, эффективной для быстрой обработки потока данных и последующего внедрения в приложение;
- обучение ResNet для классификации 
- механизмы для улучшения качества детекции;
- разработка мобильного приложения, которое может быть запущено в фоновом режиме с целью постоянного отслеживания состояния водителя;

Идеи на подумать:
- обучение нейронной сети с учетом особенностей внешности водителя;
- рассылка оповещений о спящих водителях руководству организации, если приложением пользуется водитель такси;

## 1.2 Кому будет полезно
Наша разработка в теоретическом понимании полезна всем водителям авто, особенно тем, кто работает в компаниях грузовых и пассажирских перевозок. Так работодателю будет легче убедиться в безопасности совершаемых поездок и в случае возникновения риска отследить определеннве моменты и наложить некоторые санкции на виновника потенциального ДТП.

# Реализация с технической точки зрения

## 2.1 Постановка задачи
- рекомендательная система, поиск признаков усталости водителя и детекция в соответствии с ними, оптимизация, разработка функционирующего мобильного приложения с внедрением необходимого функционала;

## 2.2 Блок-схема решения
- Блок-схема для основного MVP, включая основные этапы на пути к реализации поставленной цели: поиск датасета, его разметка, обучение на полученных данных нейронной сети, оптимизация полученного решения, разработка мобильного приложения, внедрение нейронной сети, тестирование, устранение багов и т.д.
![image](https://github.com/Darya1488/Sleeping_driver_detection/assets/80621539/243809cd-707c-4bab-9fe2-7ca54ad29c4f)

### блок-схема расположена в корне репозитория(будет позже)

## Этапы решения задачи
- Этап 1 - поиск подходящих для задачи данных на Kaggle;
- Этап 2 - разметка данных с помощью LabelMe;
- Этап 3 - обучение Yolo5, ResNet на полученной выборке;
- Этап 4 - улучшение полученных результатов при помощи различных инструментов(изменение гиперпараметров таких как learning rate, optimizer);
- Этап 5 - разработка прототипа мобильного приложения для пользователей в AndroidStudio;
- Этап 6 - интегрирование обученной сети в приложение;
- Этап 7 - тестирование;
- Этап 8 - устранение багов и прочих недоразумений;
- Этап 9 - подготовка финального отчета;
## Реализация
Сначала мы пытались обучить Yolov5, но её было недостаточно, она не размечала каждый фрейм на видео, поэтому было принято решение перейти на пофреймовую классификацию с помощью ResNet, при обучении модели данные разделялись на обучающую,тестовую и валидационные датасеты. Модель доступна для скачивания по ссылке: https://drive.google.com/file/d/1FM3g6rRLK9tqHvYRKh0AVvVmxsgLEShx/view?usp=sharing
## Используемые датасеты:
- https://www.kaggle.com/datasets/hazemfahmy/openned-closed-eyes - обычные глаза, не показали хорошей результативности, так как сонливость человека выражается не только глазами, но и зевотой и положением головы.
- https://www.kaggle.com/datasets/matjazmuc/frame-level-driver-drowsiness-detection-fl3d - много повторяющихся картинок, тоже не было хорошего результата
- https://www.kaggle.com/datasets/rakibuleceruet/drowsiness-prediction-dataset - много картинок в разном освещении, в конечном итоге использовали именно этот датасет.

## Условия успеха проекта
- Проект будет успешен в том случае, когда будет показывать точность(accuracy) не менее 95%, и будет хорошо работать на реальных кейсах.

## Использование конечного продукта:
- Скачивание приложения с AppStore или GooglePlay, в приложении есть возможность использования как фронтальной камеры телефона, так и отдельной камеры, которая подключается к приложению через Bluetooth, при детектировании сонливости водителя раздаётся звуковой сигнал, который не даёт водителю заснуть.

## Технические требования для скачивания приложения:
- Минимальные требования: потребуется примерно 500мб свободной памяти ПЗУ и 2гб ОЗУ, пропускная способность сети ~100 Мбит/c

## Дальнейшее развитие проекта:
Для обновления контента, и возможной доработки модели классификации понадобится сервер с GPU
  
